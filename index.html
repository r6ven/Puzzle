<!DOCTYPE html><html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <title>50 ParÃ§alÄ± Puzzle Oyunu</title>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; background: #444; }
    #congrats {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%) scale(0.5);
      opacity: 0;
      font-size: 2rem;
      color: #fff;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
      pointer-events: none;
      z-index: 10;
    }
    .show {
      animation: showAnim 1s forwards;
    }
    @keyframes showAnim {
      0%   { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
      60%  { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
      100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
  </style>
</head>
<body>
  <div id="congrats">Seni Ã§ok seviyorum ðŸ’–</div>
  <script>
    const config = { type: Phaser.AUTO, width: 360, height: 900, backgroundColor: '#333', parent: document.body, scene: { preload, create } };
    new Phaser.Game(config);function preload() {
  this.load.image('puzzle', '1000156285.jpg');
}

function drawPieceShape(ctx, w, h, top, right, bottom, left) {
  const b = Math.min(w, h) / 4;
  ctx.beginPath();
  // Ãœst kenar
  ctx.moveTo(left ? b : 0, 0);
  ctx.lineTo(w/2 - b, 0);
  if (top) ctx.arc(w/2, 0, b, Math.PI, 0, false);
  ctx.lineTo(w - (right ? b : 0), 0);
  // SaÄŸ kenar
  ctx.lineTo(w, h/2 - b);
  if (right) ctx.arc(w, h/2, b, -Math.PI/2, Math.PI/2, false);
  ctx.lineTo(w, h - (bottom ? b : 0));
  // Alt kenar
  ctx.lineTo(w/2 + b, h);
  if (bottom) ctx.arc(w/2, h, b, 0, Math.PI, false);
  ctx.lineTo(left ? b : 0, h);
  // Sol kenar
  ctx.lineTo(0, h/2 + b);
  if (left) ctx.arc(0, h/2, b, Math.PI/2, -Math.PI/2, false);
  ctx.lineTo(0, top ? b : 0);
  ctx.closePath();
}

function create() {
  const cols = 10, rows = 5;
  const img = this.textures.get('puzzle').getSourceImage();
  const frameX = 10, frameY = 10;
  const frameW = config.width - 20;
  const scale = frameW / img.width;
  const frameH = img.height * scale;

  // Ã‡erÃ§eve
  this.add.graphics().lineStyle(4, 0xffffff).strokeRect(frameX, frameY, frameW, frameH);

  // Kenar dizileri
  const topE = Array.from({length: rows}, () => Array(cols).fill(false));
  const bottomE = Array.from({length: rows}, () => Array(cols).fill(false));
  const leftE = Array.from({length: rows}, () => Array(cols).fill(false));
  const rightE = Array.from({length: rows}, () => Array(cols).fill(false));

  // Yatay kenarlar (Ã¼st-alt)
  for (let r = 0; r < rows; r++) {
    for (let c = 0; c < cols; c++) {
      topE[r][c] = r === 0 ? false : !bottomE[r-1][c];
      bottomE[r][c] = r === rows-1 ? false : !topE[r][c];
    }
  }
  // Dikey kenarlar (sol-saÄŸ)
  for (let r = 0; r < rows; r++) {
    for (let c = 0; c < cols; c++) {
      leftE[r][c] = c === 0 ? false : !rightE[r][c-1];
      rightE[r][c] = c === cols-1 ? false : !leftE[r][c];
    }
  }

  const pieces = [];
  const pw = frameW / cols, ph = frameH / rows;
  const startY = frameY + frameH + 20;

  // ParÃ§alarÄ± oluÅŸtur
  for (let r = 0; r < rows; r++) {
    for (let c = 0; c < cols; c++) {
      const idx = r * cols + c;
      // Canvas parÃ§a
      const cv = document.createElement('canvas'); cv.width = pw; cv.height = ph;
      const ctx = cv.getContext('2d');
      drawPieceShape(ctx, pw, ph, topE[r][c], rightE[r][c], bottomE[r][c], leftE[r][c]);
      ctx.clip('evenodd');
      ctx.drawImage(img,
        c * (img.width/cols), r * (img.height/rows), img.width/cols, img.height/rows,
        0, 0, pw, ph
      );
      this.textures.addCanvas('piece'+idx, cv);

      // ParÃ§a izi
      const outline = document.createElement('canvas'); outline.width = pw; outline.height = ph;
      const octx = outline.getContext('2d');
      drawPieceShape(octx, pw, ph, topE[r][c], rightE[r][c], bottomE[r][c], leftE[r][c]);
      octx.lineWidth = 2; octx.strokeStyle='rgba(255,255,255,0.3)'; octx.stroke();
      this.textures.addCanvas('outline'+idx, outline);

      // Outline Ã§erÃ§eve iÃ§ine
      this.add.image(
        frameX + c*pw + pw/2,
        frameY + r*ph + ph/2,
        'outline'+idx
      ).setDisplaySize(pw, ph);

      // Rastgele karÄ±ÅŸÄ±k baÅŸlangÄ±Ã§
      const spr = this.add.image(
        Phaser.Math.Between(pw/2, config.width-pw/2),
        Phaser.Math.Between(startY, config.height-ph/2),
        'piece'+idx
      ).setInteractive().setDisplaySize(pw, ph);
      this.input.setDraggable(spr);
      pieces.push({spr, x: frameX+c*pw+pw/2, y: frameY+r*ph+ph/2});
    }
  }

  // SÃ¼rÃ¼kle bÄ±rak ve kontrol
  this.input.on('drag', (_,gameObject,dx,dy)=>{ gameObject.x=dx; gameObject.y=dy; });
  this.input.on('dragend', ()=>{
    if(pieces.every(p=> Phaser.Math.Distance.Between(p.spr.x,p.spr.y,p.x,p.y)<20)){
      document.getElementById('congrats').classList.add('show');
    }
  });
}

  </script>
</body>
</html>