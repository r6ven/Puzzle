<!DOCTYPE html><html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  <title>10 Par√ßalƒ± Puzzle Oyunu</title>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.min.js"></script>
  <style>
    body { margin: 0; overflow: hidden; background: #444; }
    #congrats {
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%) scale(0.5);
      opacity: 0;
      font-size: 2rem;
      color: #fff;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
      pointer-events: none;
      z-index: 10;
    }
    /* Animasyonlu g√∂sterim ve son durum */
    #congrats.show {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
      animation: showAnim 1s forwards;
    }
    @keyframes showAnim {
      0%   { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
      60%  { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
      100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
  </style>
</head>
<body>
  <div id="congrats">Seni √ßok seviyorum üíñ</div>
  <script>
    const config = {
      type: Phaser.AUTO,
      width: 360 * 3,    // x3 √∂l√ßekte geni≈ülik
      height: 600 * 3,   // x3 √∂l√ßekte y√ºkseklik
      backgroundColor: '#333',
      parent: document.body,
      scene: { preload, create }
    };
    new Phaser.Game(config);function preload() {
  this.load.image('puzzle', '1000156285.jpg');
}

function create() {
  const cols = 5, rows = 2;
  const total = cols * rows;
  const img = this.textures.get('puzzle').getSourceImage();
  const frameX = 10, frameY = 10;
  const frameW = config.width - 20;
  const scale = frameW / img.width;
  const frameH = img.height * scale;

  // √áer√ßeve ve slotlar
  const graphics = this.add.graphics();
  graphics.lineStyle(4, 0xffffff).strokeRect(frameX, frameY, frameW, frameH);

  const pw = frameW / cols, ph = frameH / rows;
  const slots = [];
  for (let r = 0; r < rows; r++) {
    for (let c = 0; c < cols; c++) {
      const x = frameX + c * pw;
      const y = frameY + r * ph;
      // slot outline
      graphics.lineStyle(2, 0xffa500, 0.5).strokeRect(x, y, pw, ph);
      slots.push({ x: x + pw/2, y: y + ph/2 });
    }
  }

  // Par√ßalar
  const pieces = [];
  let placed = 0;
  const startY = frameY + frameH + 20;
  const snapDist = pw;  // tam h√ºcre geni≈üliƒüinde

  for (let i = 0; i < total; i++) {
    const c = i % cols;
    const r = Math.floor(i / cols);
    const sx = slots[i].x;
    const sy = slots[i].y;

    // Canvas ile kƒ±rpƒ±lmƒ±≈ü par√ßa
    const cv = document.createElement('canvas'); cv.width = pw; cv.height = ph;
    const ctx = cv.getContext('2d');
    ctx.drawImage(img,
      c * (img.width/cols), r * (img.height/rows), img.width/cols, img.height/rows,
      0, 0, pw, ph
    );
    this.textures.addCanvas('piece'+i, cv);

    const spr = this.add.image(
      Phaser.Math.Between(pw/2, config.width-pw/2),
      Phaser.Math.Between(startY, config.height-ph/2),
      'piece'+i
    ).setInteractive().setDisplaySize(pw, ph);
    this.input.setDraggable(spr);

    spr.correctX = sx;
    spr.correctY = sy;
    spr.placed = false;
    pieces.push(spr);
  }

  // Drag & drop
  this.input.on('drag', (_, gameObject, dragX, dragY) => {
    if (!gameObject.placed) {
      gameObject.x = dragX;
      gameObject.y = dragY;
    }
  });

  this.input.on('dragend', (_, gameObject) => {
    // Mesafe kontrol√º ve loglama
    const dist = Phaser.Math.Distance.Between(
      gameObject.x, gameObject.y,
      gameObject.correctX, gameObject.correctY
    );
    console.log('dist:', dist, 'snapDist:', snapDist, 'placed before:', placed);
    if (!gameObject.placed && dist < snapDist) {
      gameObject.x = gameObject.correctX;
      gameObject.y = gameObject.correctY;
      gameObject.placed = true;
      gameObject.disableInteractive();
      placed++;
      console.log('Placed:', placed, '/', total);
      if (placed === total) {
        document.getElementById('congrats').classList.add('show');
      }
    }
  });
}

  </script>
</body>
</html>